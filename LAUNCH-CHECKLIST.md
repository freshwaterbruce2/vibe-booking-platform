# Launch & Monetization Checklist (Square Integration)

This checklist outlines the critical steps to ensure a successful and profitable launch for the Vibe Booking platform using Square for payments.

---

### 1. ✅ Configuration & Secrets Management (CRITICAL)

*Your application and CI/CD pipelines will fail without these settings.*

- [ ] **GitHub Secrets:** Configure the following secrets in your repository settings under `Settings > Secrets and variables > Actions`:
  - `SQUARE_ACCESS_TOKEN`: Your Square production access token.
  - `SQUARE_LOCATION_ID`: The ID of the business location you are processing payments for.
  - `AWS_ACCESS_KEY_ID`: For deploying to AWS.
  - `AWS_SECRET_ACCESS_KEY`: For deploying to AWS.
  - `SNYK_TOKEN`: For security scanning with Snyk.
  - `SONAR_TOKEN`: For code quality analysis with SonarQube.
  - `LHCI_GITHUB_APP_TOKEN`: For Lighthouse performance monitoring.
  - `SLACK_WEBHOOK_URL`: For deployment notifications.
  - `PAGERDUTY_TOKEN`: For incident management.
  - `PAGERDUTY_SERVICE_ID`: For incident management.

- [ ] **Local Development Environment (.env):** Create a `.env` file in the project's **root directory** with the following:
  ```
  VITE_SQUARE_APPLICATION_ID="sandbox-sq0idb-..."
  VITE_SQUARE_LOCATION_ID="L..."
  ```

- [ ] **Backend Environment (.env):** Create a `.env` file in the **`/backend` directory** with the following:
  ```
  SQUARE_ACCESS_TOKEN="EAAAE..."
  SQUARE_ENVIRONMENT="sandbox"
  ```

---

### 2. ✅ Backend Implementation (Core Monetization Logic)

- [ ] **Square Service:** Implement the logic in `backend/src/services/squareService.ts` to communicate with the Square API for creating payments and managing customers.
- [ ] **Payment API Endpoints:** Build out the API endpoints in `backend/src/routes/payments.ts`. At a minimum, you need an endpoint like `/api/payments/create` that takes a `sourceId` from the frontend and an amount, then calls the Square Payments API.
- [ ] **Database Schema:** Run the updated `sqlite-payment-schema.sql` against your database to ensure the tables are set up with Square-specific fields (`square_customer_id`, `square_payment_id`, etc.).
- [ ] **Webhook Security:** Implement webhook signature verification for Square webhooks to securely receive payment status updates.

---

### 3. ✅ Frontend Implementation (User-Facing Payment Flow)

- [ ] **Square Payment Form:** Integrate the `SquarePaymentForm` component from `src/components/payment/SquarePaymentForm.tsx` into your application's checkout or subscription page.
- [ ] **Payment Hook:** Implement the `useSquarePayment` hook (`src/hooks/useSquarePayment.ts`) to manage the state of the payment form and handle the tokenization process.
- [ ] **Environment Variables:** Ensure the Vite frontend can access the Square Application ID and Location ID from your `.env` file.

---

### 4. ✅ Testing & Quality Assurance

- [ ] **Payment Flow Testing:** Write and run comprehensive tests for the entire payment flow. Use Square's sandbox environment and test card numbers.
- [ ] **E2E Tests:** Update or create Playwright E2E tests (`tests/e2e/`) to cover the payment and subscription user journeys.
- [ ] **Git Hooks:** Run `npm install` to ensure Husky is installed correctly. Test the `pre-commit` and `pre-push` hooks by making a small change and attempting to commit and push it.

---

### 5. ✅ Deployment & Go-Live

- [ ] **Staging Deployment:** Perform a full deployment to a staging environment to test the CI/CD pipeline and ensure all services are working correctly with sandbox credentials.
- [ ] **Production Credentials:** Before the final deployment, switch all Square-related environment variables and secrets from `sandbox` to `production` values.
- [ ] **Square Webhooks:** In your Square Developer Dashboard, configure the webhook URLs to point to your production backend endpoint (e.g., `https://your-domain.com/api/webhooks/square`).
- [ ] **Final Deployment:** Run the `production-deployment.yml` workflow to deploy to your production environment.

---
*This checklist was generated by the GitHub Copilot Agent on 2025-08-11.*
